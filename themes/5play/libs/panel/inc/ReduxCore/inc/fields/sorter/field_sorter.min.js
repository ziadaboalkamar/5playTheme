(function(b){redux.field_objects=redux.field_objects||{};redux.field_objects.sorter=redux.field_objects.sorter||{};var a="";b(document).ready(function(){});redux.field_objects.sorter.init=function(c){if(!c){c=b(document).find(".redux-group-tab:visible").find(".redux-container-sorter:visible")}b(c).each(function(){var e=b(this);var d=e;if(!e.hasClass("redux-field-container")){d=e.parents(".redux-field-container:first")}if(d.is(":hidden")){return}if(d.hasClass("redux-field-init")){d.removeClass("redux-field-init")}else{return}e.find(".redux-sorter").each(function(){var f=b(this).attr("id");e.find("#"+f).find("ul").sortable({items:"li",placeholder:"placeholder",connectWith:".sortlist_"+f,opacity:0.8,scroll:false,out:function(g,h){if(!h.helper){return}if(h.offset.top>0){a="down"}else{a="up"}redux.field_objects.sorter.scrolling(b(this).parents(".redux-field-container:first"))},over:function(g,h){a=""},deactivate:function(g,h){a=""},stop:function(g,h){var j=redux.sorter[b(this).attr("data-id")];var i=b(this).find("h3").text();if(j.limits&&i&&j.limits[i]){if(b(this).children("li").length>=j.limits[i]){b(this).addClass("filled");if(b(this).children("li").length>j.limits[i]){b(h.sender).sortable("cancel")}}else{b(this).removeClass("filled")}}},update:function(g,h){var j=redux.sorter[b(this).attr("data-id")];var i=b(this).find("h3").text();if(j.limits&&i&&j.limits[i]){if(b(this).children("li").length>=j.limits[i]){b(this).addClass("filled");if(b(this).children("li").length>j.limits[i]){b(h.sender).sortable("cancel")}}else{b(this).removeClass("filled")}}b(this).find(".position").each(function(){var k=b(this).parent().attr("data-id");var m=b(this).parent().parent().attr("data-group-id");redux_change(b(this));var l=b(this).parent().parent().parent().attr("id");b(this).prop("name",redux.args.opt_name+"["+l+"]["+m+"]["+k+"]")})}});e.find(".redux-sorter").disableSelection()})})};redux.field_objects.sorter.scrolling=function(c){if(c===undefined){return}var d=c.find(".redux-sorter");if(a=="up"){d.scrollTop(d.scrollTop()-20);setTimeout(redux.field_objects.sorter.scrolling,50)}else{if(a=="down"){d.scrollTop(d.scrollTop()+20);setTimeout(redux.field_objects.sorter.scrolling,50)}}}})(jQuery);