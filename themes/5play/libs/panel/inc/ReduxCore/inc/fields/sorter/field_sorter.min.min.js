(function(c){redux.field_objects=redux.field_objects||{};redux.field_objects.sorter=redux.field_objects.sorter||{};var d="";c(document).ready(function(){});redux.field_objects.sorter.init=function(a){if(!a){a=c(document).find(".redux-group-tab:visible").find(".redux-container-sorter:visible")}c(a).each(function(){var b=c(this);var f=b;if(!b.hasClass("redux-field-container")){f=b.parents(".redux-field-container:first")}if(f.is(":hidden")){return}if(f.hasClass("redux-field-init")){f.removeClass("redux-field-init")}else{return}b.find(".redux-sorter").each(function(){var e=c(this).attr("id");b.find("#"+e).find("ul").sortable({items:"li",placeholder:"placeholder",connectWith:".sortlist_"+e,opacity:0.8,scroll:false,out:function(j,i){if(!i.helper){return}if(i.offset.top>0){d="down"}else{d="up"}redux.field_objects.sorter.scrolling(c(this).parents(".redux-field-container:first"))},over:function(j,i){d=""},deactivate:function(j,i){d=""},stop:function(n,m){var k=redux.sorter[c(this).attr("data-id")];var l=c(this).find("h3").text();if(k.limits&&l&&k.limits[l]){if(c(this).children("li").length>=k.limits[l]){c(this).addClass("filled");if(c(this).children("li").length>k.limits[l]){c(m.sender).sortable("cancel")}}else{c(this).removeClass("filled")}}},update:function(n,m){var k=redux.sorter[c(this).attr("data-id")];var l=c(this).find("h3").text();if(k.limits&&l&&k.limits[l]){if(c(this).children("li").length>=k.limits[l]){c(this).addClass("filled");if(c(this).children("li").length>k.limits[l]){c(m.sender).sortable("cancel")}}else{c(this).removeClass("filled")}}c(this).find(".position").each(function(){var i=c(this).parent().attr("data-id");var g=c(this).parent().parent().attr("data-group-id");redux_change(c(this));var h=c(this).parent().parent().parent().attr("id");c(this).prop("name",redux.args.opt_name+"["+h+"]["+g+"]["+i+"]")})}});b.find(".redux-sorter").disableSelection()})})};redux.field_objects.sorter.scrolling=function(b){if(b===undefined){return}var a=b.find(".redux-sorter");if(d=="up"){a.scrollTop(a.scrollTop()-20);setTimeout(redux.field_objects.sorter.scrolling,50)}else{if(d=="down"){a.scrollTop(a.scrollTop()+20);setTimeout(redux.field_objects.sorter.scrolling,50)}}}})(jQuery);