jQuery.uaMatch=function(b){b=b.toLowerCase();var a=/(chrome)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+)/.exec(b)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b)||/(msie) ([\w.]+)/.exec(b)||b.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b)||[];return{browser:a[1]||"",version:a[2]||"0"}};(function(L,K){var J="ui-state-active",I="ui-state-hover",H="ui-state-disabled",G=L.ui.keyCode,F=G.UP,E=G.DOWN,D=G.RIGHT,C=G.LEFT,B=G.PAGE_UP,A=G.PAGE_DOWN,z=G.HOME,y=G.END,x=L.uaMatch.msie,w=L.uaMatch.mozilla?"DOMMouseScroll":"mousewheel",v=".uispinner",u=[F,E,D,C,B,A,z,y,G.BACKSPACE,G.DELETE,G.TAB],t;L.widget("ui.spinner",{options:{min:null,max:null,allowNull:false,group:"",point:".",prefix:"",suffix:"",places:null,defaultStep:1,largeStep:10,mouseWheel:true,increment:"slow",className:null,showOn:"always",width:95,upIconClass:"ui-icon-triangle-1-n",downIconClass:"ui-icon-triangle-1-s",format:function(g,f){var j=this,i=/(\d+)(\d{3})/,h=(isNaN(g)?0:Math.abs(g)).toFixed(f)+"";for(h=h.replace(".",j.point);i.test(h)&&j.group;h=h.replace(i,"$1"+j.group+"$2")){}return(g<0?"-":"")+j.prefix+h+j.suffix},parse:function(d){var c=this;if(c.group=="."){d=d.replace(".","")}if(c.point!="."){d=d.replace(c.point,".")}return parseFloat(d.replace(/[^0-9\-\.]/g,""))}},_create:function(){var e=this,d=e.element,f=d.attr("type");if(!d.is("input")||f!="text"&&f!="number"){console.error("Invalid target for ui.spinner");return}e._procOptions(true);e._createButtons(d);if(!d.is(":enabled")){e.disable()}},_createButtons:function(ae){function c(){if(j){L(this).removeClass(J);ac._stopSpin();j=false}return false}function d(){if(!X.disabled){var e=ac.element[0],p=this===Z?1:-1;e.focus();e.select();L(this).addClass(J);j=true;ac._startSpin(p)}return false}function f(p){function e(){s=0;p()}if(s){if(p===q){return}clearTimeout(s)}q=p;s=setTimeout(e,100)}function g(p,e){if(k){return false}var N=String.fromCharCode(e||p),M=ac.options;if(N>="0"&&N<="9"||N=="-"){return false}if(ac.places>0&&N==M.point||N==M.group){return false}return true}function h(p){for(var e=0;e<u.length;e++){if(u[e]==p){return true}}return false}function ad(b){return b=="auto"?0:parseInt(b)}var ac=this,X=ac.options,V=X.className,T=X.width,r=X.showOn,n=ae.outerHeight(),l=ac.oMargin=ad(ae.css("margin-right")),ab=ac.wrapper=ae.wrap('<span class="spinner-wrpr" />').css({width:(ac.oWidth=ae.outerWidth())-T,marginRight:"30px",marginLeft:"30px",textAlign:"center","float":"none",marginTop:0}).after('<span class="ui-spinner ui-widget"></span>').next(),aa=ac.btnContainer=L('<div class="ui-spinner-buttons"><div class="ui-spinner-up ui-spinner-button ui-state-default ui-corner-tr"><span class="ui-icon '+X.upIconClass+'"> </span></div><div class="ui-spinner-down ui-spinner-button ui-state-default ui-corner-br"><span class="ui-icon '+X.downIconClass+'"> </span></div></div>'),Z,Y,W,U,s,q,o,m,k,j,i=ae[0].dir=="rtl";if(V){ab.addClass(V)}ab.append(aa.css({height:n,left:0,top:0}));W=ac.buttons=aa.find(".ui-spinner-button");W.css({width:"30px",height:n-(0)});W.eq(0).css({right:"0"});W.eq(1).css({left:"0"});Z=W[0];Y=W[1];U=W.find(".ui-icon");aa.width("105px");if(r!="always"){aa.css("opacity",0)}if(r=="hover"||r=="both"){W.add(ae).bind("mouseenter"+v,function(){f(function(){o=true;if(!ac.focused||r=="hover"){ac.showButtons()}})}).bind("mouseleave"+v,function a(){f(function(){o=false;if(!ac.focused||r=="hover"){ac.hideButtons()}})})}W.hover(function(){ac.buttons.removeClass(I);if(!X.disabled){L(this).addClass(I)}},function(){L(this).removeClass(I)}).mousedown(d).mouseup(c).mouseout(c);if(x){W.dblclick(function(){if(!X.disabled){ac._change();ac._doSpin((this===Z?1:-1)*X.step)}return false}).bind("selectstart",function(){return false})}ae.bind("keydown"+v,function(p){var P,N,M,O=p.keyCode;if(p.ctrl||p.alt){return true}if(h(O)){k=true}if(m){return false}switch(O){case F:case B:P=1;N=O==B;break;case E:case A:P=-1;N=O==A;break;case D:case C:P=O==D^i?1:-1;break;case z:M=ac.options.min;if(M!=null){ac._setValue(M)}return false;case y:M=ac.options.max;M=ac.options.max;if(M!=null){ac._setValue(M)}return false}if(P){if(!m&&!X.disabled){keyDir=P;L(P>0?Z:Y).addClass(J);m=true;ac._startSpin(P,N)}return false}}).bind("keyup"+v,function(b){if(b.ctrl||b.alt){return true}if(h(G)){k=false}switch(b.keyCode){case F:case D:case B:case E:case C:case A:W.removeClass(J);ac._stopSpin();m=false;return false}}).bind("keypress"+v,function(b){if(g(b.keyCode,b.charCode)){return false}}).bind("change"+v,function(){ac._change()}).bind("focus"+v,function(){function b(){ac.element.select()}x?b():setTimeout(b,0);ac.focused=true;t=ac;if(!o&&(r=="focus"||r=="both")){ac.showButtons()}}).bind("blur"+v,function(){ac.focused=false;if(!o&&(r=="focus"||r=="both")){ac.hideButtons()}})},_procOptions:function(M){var s=this,r=s.element,q=s.options,p=q.min,o=q.max,n=q.step,m=q.places,l=-1,k;if(q.increment=="slow"){q.increment=[{count:1,mult:1,delay:250},{count:3,mult:1,delay:100},{count:0,mult:1,delay:50}]}else{if(q.increment=="fast"){q.increment=[{count:1,mult:1,delay:250},{count:19,mult:1,delay:100},{count:80,mult:1,delay:20},{count:100,mult:10,delay:20},{count:0,mult:100,delay:20}]}}if(p==null&&(k=r.attr("min"))!=null){p=parseFloat(k)}if(o==null&&(k=r.attr("max"))!=null){o=parseFloat(k)}if(!n&&(k=r.attr("step"))!=null){if(k!="any"){n=parseFloat(k);q.largeStep*=n}}q.step=n=n||q.defaultStep;if(m==null&&(k=n+"").indexOf(".")!=-1){m=k.length-k.indexOf(".")-1}s.places=m;if(o!=null&&p!=null){if(p>o){p=o}l=Math.max(Math.max(l,q.format(o,m,r).length),q.format(p,m,r).length)}if(M){s.inputMaxLength=r[0].maxLength}k=s.inputMaxLength;if(k>0){l=l>0?Math.min(k,l):k;k=Math.pow(10,l)-1;if(o==null||o>k){o=k}k=-(k+1)/10+1;if(p==null||p<k){p=k}}if(l>0){r.attr("maxlength",l)}q.min=p;q.max=o;s._change();r.unbind(w+v);if(q.mouseWheel){r.bind(w+v,s._mouseWheel)}},_mouseWheel:function(a){var d=L.data(this,"spinner");if(!d.options.disabled&&d.focused&&t===d){d._change();d._doSpin(((a.wheelDelta||-a.detail)>0?1:-1)*d.options.step);return false}},_setTimer:function(g,f,j){function h(){i._spin(f,j)}var i=this;i._stopSpin();i.timer=setInterval(h,g)},_stopSpin:function(){if(this.timer){clearInterval(this.timer);this.timer=0}},_startSpin:function(g,f){var j=this,i=j.options,h=i.increment;j._change();j._doSpin(g*(f?j.options.largeStep:j.options.step));if(h&&h.length>0){j.counter=0;j.incCounter=0;j._setTimer(h[0].delay,g,f)}},_spin:function(g,f){var j=this,i=j.options.increment,h=i[j.incCounter];j._doSpin(g*h.mult*(f?j.options.largeStep:j.options.step));j.counter++;if(j.counter>h.count&&j.incCounter<i.length-1){j.counter=0;h=i[++j.incCounter];j._setTimer(h.delay,g,f)}},_doSpin:function(e){var d=this,f=d.curvalue;if(f==null){f=(e>0?d.options.min:d.options.max)||0}d._setValue(f+e)},_parseValue:function(){var b=this.element.val();return b?this.options.parse(b,this.element):null},_validate:function(f){var e=this.options,h=e.min,g=e.max;if(f==null&&!e.allowNull){f=this.curvalue!=null?this.curvalue:h||g||0}if(g!=null&&f>g){return g}else{if(h!=null&&f<h){return h}else{return f}}},_change:function(){var f=this,e=f._parseValue(),h=f.options.min,g=f.options.max;if(!f.selfChange){if(isNaN(e)){e=f.curvalue}f._setValue(e,true)}},_setOption:function(a,d){L.Widget.prototype._setOption.call(this,a,d);this._procOptions()},increment:function(){this._doSpin(this.options.step)},decrement:function(){this._doSpin(-this.options.step)},showButtons:function(d){var c=this.btnContainer.stop();if(d){c.css("opacity",1)}else{c.fadeTo("fast",1)}},hideButtons:function(d){var c=this.btnContainer.stop();if(d){c.css("opacity",0)}else{c.fadeTo("fast",0)}this.buttons.removeClass(I)},_setValue:function(e,d){var f=this;f.curvalue=e=f._validate(e);f.element.val(e!=null?f.options.format(e,f.places,f.element):"");if(!d){f.selfChange=true;f.element.change();f.selfChange=false}},value:function(b){if(arguments.length){this._setValue(b);return this.element}return this.curvalue},enable:function(){this.buttons.removeClass(H);this.element[0].disabled=false;L.Widget.prototype.enable.call(this)},disable:function(){this.buttons.addClass(H).removeClass(I);this.element[0].disabled=true;L.Widget.prototype.disable.call(this)},destroy:function(a){this.wrapper.remove();this.element.unbind(v).css({width:this.oWidth,marginRight:this.oMargin});L.Widget.prototype.destroy.call(this)}})})(jQuery);