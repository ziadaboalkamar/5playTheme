import{z as I,b as P,u as N,H as T}from"./links.96235554.js";import{V as F,S as Y,a as H}from"./Statistic.d98c0aaa.js";import{C as $,b as j}from"./Caret.7f04b0aa.js";import{a as G,C as K}from"./Tooltip.c031cb66.js";import{n as x}from"./numbers.8fa607e7.js";import{n as C}from"./isArrayLikeObject.3ade28da.js";import{C as V}from"./Portal.72ce36ea.js";import{R as B}from"./SeoRevisions.fd5dbff2.js";import{t as O}from"./html.671743b1.js";import{U as L}from"./UserAvatar.374a3d02.js";import{r as _,o as n,d as f,w as g,g as S,t as d,a as r,e as v,c,b as h,i as k,I as q,N as X,H as A,F as M,h as E,n as D,B as Z}from"./vue.runtime.esm-bundler.a49acf4f.js";import{_ as R}from"./_plugin-vue_export-helper.bd508f36.js";import{S as Q}from"./Eye.5a8f97a6.js";import{b as J,S as ee}from"./index.c885ab17.js";const te={setup(){return{searchStatisticsStore:I(),seoRevisionsStore:P()}},components:{CoreModalPortal:V,UtilUserAvatar:L},methods:{initDelete(){this.btnDeleteRevisionLoading=!0,this.seoRevisionsStore.delete(this.revision.id).then(t=>{this.$parent.modalOpenDeleteRevisionWarning=!1,this.seoRevisionsStore.items=t.body.items,this.searchStatisticsStore.deleteSeoRevision(this.revision)}).finally(()=>{this.btnDeleteRevisionLoading=!1})},truncate:O},mixins:[B],props:{modalOpenDeleteRevisionWarning:{type:Boolean,required:!0},revision:{type:Object,required:!0}},data(){return{btnDeleteRevisionLoading:!1,strings:{areYouSureDeleteRevision:this.$t.__("Are you sure you want to delete the following revision? This cannot be undone.",this.$tdPro),deleteRevision:this.$t.__("Delete Revision",this.$tdPro),noChangedMind:this.$t.__("No, I changed my mind",this.$tdPro),revisionBy:this.$t.__("Revision by",this.$tdPro),yesDeleteRevision:this.$t.__("Yes, delete revision",this.$tdPro)}}}},se={class:"aioseo-seo-revisions-delete-warning__body"},ie={class:"aioseo-seo-revisions-delete-warning__text"},oe={class:"aioseo-seo-revisions-delete-warning__revision"},re={class:"aioseo-seo-revisions-delete-warning__revision__avatar"},ne={class:"aioseo-seo-revisions-delete-warning__revision__data text-truncate"},ae=["title"],le=["textContent"],de=r("span",null,"Â ",-1),he=["textContent"],ce=["textContent"],me={class:"aioseo-seo-revisions-delete-warning__revision__data__date"},ue=r("br",null,null,-1),_e={class:"aioseo-seo-revisions-delete-warning__action"};function pe(t,e,i,l,s,o){const a=_("util-user-avatar"),m=_("base-button"),y=_("core-modal-portal");return t.$parent.modalOpenDeleteRevisionWarning?(n(),f(y,{key:0,onClose:e[2]||(e[2]=b=>t.$parent.modalOpenDeleteRevisionWarning=!1),classes:["aioseo-seo-revisions-delete-warning"]},{headerTitle:g(()=>[S(d(s.strings.deleteRevision),1)]),body:g(()=>{var b,p,u;return[r("div",se,[r("p",ie,d(s.strings.areYouSureDeleteRevision),1),r("div",oe,[r("div",re,[v(a,{src:i.revision.author.avatar.url,size:i.revision.author.avatar.size},null,8,["src","size"])]),r("div",ne,[r("span",{title:t.getAuthorEmailAndLogin(i.revision),class:"aioseo-seo-revisions-delete-warning__revision__data__author"},[r("span",{textContent:d(s.strings.revisionBy)},null,8,le),de,r("span",{textContent:d(o.truncate(i.revision.author.display_name,30))},null,8,he)],8,ae),(b=i.revision)!=null&&b.note?(n(),c("span",{key:0,class:"aioseo-seo-revisions-delete-warning__revision__data__note",textContent:d(i.revision.note)},null,8,ce)):h("",!0),r("span",me,[ue,S(" "+d((u=(p=i.revision)==null?void 0:p.date)==null?void 0:u.created_formatted),1)])])]),r("div",_e,[v(m,{type:"gray",size:"medium",onClick:e[0]||(e[0]=k(w=>t.$parent.modalOpenDeleteRevisionWarning=!1,["prevent","exact"]))},{default:g(()=>[S(d(s.strings.noChangedMind),1)]),_:1}),v(m,{type:"blue",size:"medium",loading:s.btnDeleteRevisionLoading,onClick:e[1]||(e[1]=k(w=>o.initDelete(),["prevent","exact"]))},{default:g(()=>[S(d(s.strings.yesDeleteRevision),1)]),_:1},8,["loading"])])])]}),_:1})):h("",!0)}const ve=R(te,[["render",pe]]);const ge={setup(){return{rootStore:N(),searchStatisticsStore:I(),seoRevisionsStore:P()}},components:{CoreLoader:$,SvgEye:Q,SvgTrash:J,UtilUserAvatar:L},computed:{itemCompareUrl(){return this.compareTo.id?`${this.rootStore.aioseo.urls.aio.seoRevisions}&from=${this.revision.id}&to=${this.compareTo.id}`:`${this.rootStore.aioseo.urls.aio.seoRevisions}&from=${this.revision.id}&to=${this.seoRevisionsStore.items[0].id}`},itemViewUrl(){return`${this.rootStore.aioseo.urls.aio.seoRevisions}&to=${this.revision.id}`}},methods:{truncate:O,focusInputNote(){setTimeout(()=>{this.$refs.itemWrapper.querySelector("input").focus()},50)},onBlurInputNote(){this.noteElements.input.value!==this.revision.note?this.updateNote():this.onKeyUpEscInputNote()},onKeyUpEnterInputNote(){this.noteElements.input.value!==this.revision.note&&this.updateNote()},onKeyUpEscInputNote(){this.noteElements.input.value=this.revision.note,this.setNoteElementVisibility("input",!1)},onClickBtnAddNote(){this.setNoteElementVisibility("input",!0),this.setNoteElementVisibility("btnAdd",!1),this.focusInputNote()},onClickBtnEditNote(){this.setNoteElementVisibility("input",!0),this.setNoteElementVisibility("btnEdit",!1),this.focusInputNote()},onFocusItem(){this.onMouseEnterItem()},onMouseEnterItem(){this.isNoteElementVisible("input")||(this.revision.note?this.setNoteElementVisibility("btnEdit",!0):this.setNoteElementVisibility("btnAdd",!0))},onMouseLeaveItem(){this.setNoteElementVisibility("btnAdd",!1),this.setNoteElementVisibility("btnEdit",!1)},isNoteElementVisible(t){return this.noteElements[t].visible},setNoteElementVisibility(t,e){this.noteElements[t].visible=e},updateNote(){this.isUpdating=!0,this.seoRevisionsStore.update({id:this.revision.id,payload:{note:this.noteElements.input.value}}).then(t=>{const e=this.seoRevisionsStore.items.findIndex(i=>i.id===t.body.item.id);this.seoRevisionsStore.items.splice(e,1,t.body.item),this.searchStatisticsStore.updateSeoRevision(this.seoRevisionsStore.items),this.setNoteElementVisibility("input",!1)}).finally(()=>{this.isUpdating=!1})}},mixins:[B],props:{isCurrentVersion:{required:!0,type:Boolean,default(){return!1}},revision:{type:Object,default(){return{}}},compareTo:{type:Object,default(){return{}}},context:String},watch:{revision(t){this.noteElements.input.value=t.note}},data(){return{isUpdating:!1,noteElements:{input:{maxlength:this.seoRevisionsStore.noteMaxlength,visible:!1,value:this.revision.note},btnAdd:{visible:!1},btnEdit:{visible:!1}},strings:{addNote:this.$t.__("Add Note",this.$tdPro),compare:this.$t.__("Compare",this.$tdPro),compareAgainstCurrent:this.$t.__("Compare against current version",this.$tdPro),currentVersion:this.$t.__("Current Version",this.$tdPro),deleteRevision:this.$t.__("Delete revision",this.$tdPro),editNote:this.$t.__("Edit Note",this.$tdPro),typeToAddNote:this.$t.__("Type to add note",this.$tdPro),viewRevision:this.$t.__("View revision",this.$tdPro)}}}},fe={class:"aioseo-seo-revision-list-item__input-wrapper"},ye={key:0,class:"aioseo-seo-revision-list-item__note text-truncate"},be=["maxlength","placeholder"],ke={class:"aioseo-seo-revision-list-item__author"},we={class:"aioseo-seo-revision-list-item__author__avatar"},Se=["title"],xe=["title"],Ce={class:"aioseo-seo-revision-list-item__action"},De={class:"aioseo-wrapper"},Re={key:0,class:"str-current-version"},Me=["href","title"],Ee={class:"aioseo-wrapper"},Te=["href","title"],Ne=["title"],Ae={key:1,class:"loader"};function Ie(t,e,i,l,s,o){const a=_("util-user-avatar"),m=_("svg-eye"),y=_("svg-trash"),b=_("core-loader");return n(),c("div",{role:"listitem",class:"aioseo-seo-revision-list-item",tabindex:"0",ref:"itemWrapper",onFocus:e[9]||(e[9]=p=>o.onFocusItem()),onMouseenter:e[10]||(e[10]=p=>o.onMouseEnterItem()),onMouseleave:e[11]||(e[11]=p=>o.onMouseLeaveItem())},[r("div",fe,[i.revision.note&&!o.isNoteElementVisible("input")?(n(),c("span",ye,d(i.revision.note),1)):h("",!0),o.isNoteElementVisible("input")?q((n(),c("input",{key:1,type:"text",maxlength:s.noteElements.input.maxlength,placeholder:s.strings.typeToAddNote,"onUpdate:modelValue":e[0]||(e[0]=p=>s.noteElements.input.value=p),onBlur:e[1]||(e[1]=k(p=>o.onBlurInputNote(),["prevent"])),onKeyup:[e[2]||(e[2]=A(k(p=>o.onKeyUpEnterInputNote(),["prevent"]),["enter"])),e[3]||(e[3]=A(k(p=>o.onKeyUpEscInputNote(),["prevent"]),["esc"]))],onKeydown:e[4]||(e[4]=A(k(()=>{},["prevent"]),["enter"]))},null,40,be)),[[X,s.noteElements.input.value]]):h("",!0),o.isNoteElementVisible("btnEdit")?(n(),c("button",{key:2,class:"aioseo-seo-revision-list-item__btn-edit-note",onClick:e[5]||(e[5]=k(p=>o.onClickBtnEditNote(),["prevent"]))},d(s.strings.editNote),1)):h("",!0)]),r("div",ke,[r("span",we,[v(a,{src:i.revision.author.avatar.url,size:i.revision.author.avatar.size},null,8,["src","size"])]),i.revision.author.display_name?(n(),c("span",{key:0,title:t.getAuthorEmailAndLogin(i.revision),class:"aioseo-seo-revision-list-item__author__name text-truncate"},d(o.truncate(i.revision.author.display_name,30)),9,Se)):h("",!0),o.isNoteElementVisible("btnAdd")&&(i.context||this.$root._data.screenContext)==="sidebar"?(n(),c("button",{key:1,class:"aioseo-seo-revision-list-item__btn-add-note",onClick:e[6]||(e[6]=k(p=>o.onClickBtnAddNote(),["prevent"]))},d(s.strings.addNote),1)):h("",!0)]),r("div",{class:"aioseo-seo-revision-list-item__date text-truncate",title:i.revision.date.created_formatted},d(i.revision.date.created_formatted),9,xe),o.isNoteElementVisible("btnAdd")&&(i.context||this.$root._data.screenContext)==="metabox"?(n(),c("button",{key:0,class:"aioseo-seo-revision-list-item__btn-add-note",onClick:e[7]||(e[7]=k(p=>o.onClickBtnAddNote(),["prevent"]))},d(s.strings.addNote),1)):h("",!0),r("div",Ce,[r("div",De,[i.isCurrentVersion?(n(),c("div",Re,d(s.strings.currentVersion),1)):(n(),c("a",{key:1,href:o.itemCompareUrl,title:s.strings.compareAgainstCurrent,target:"_blank",class:"aioseo-seo-revision-list-item__action__compare"},d(s.strings.compare),9,Me)),r("div",Ee,[r("a",{href:o.itemViewUrl,title:s.strings.viewRevision,target:"_blank",class:"aioseo-seo-revision-list-item__action__view"},[v(m)],8,Te),i.isCurrentVersion?h("",!0):(n(),c("button",{key:0,class:"aioseo-seo-revision-list-item__action__delete",onClick:e[8]||(e[8]=k(p=>t.$emit("maybeDeleteSeoRevision",i.revision),["prevent"])),title:s.strings.deleteRevision},[v(y)],8,Ne))])])]),s.isUpdating?(n(),c("div",Ae,[v(b)])):h("",!0)],544)}const $e=R(ge,[["render",Ie],["__scopeId","data-v-04dee5be"]]),U=""+window.__aioseoDynamicImportPreload__("svg/aioseo.7d699544.svg"),z=""+window.__aioseoDynamicImportPreload__("svg/google.20babf27.svg"),W=""+window.__aioseoDynamicImportPreload__("svg/wordpress.7a824a54.svg");const Pe={setup(){return{rootStore:N()}},emits:["update"],components:{CoreModalPortal:V,SeoRevisionsDeleteWarning:ve,SeoRevisionListItem:$e,SvgCaret:j},data(){return{item:{},itemToBeDeleted:{},modalOpen:!1,modalOpenDeleteRevisionWarning:!1,strings:{theFollowingChanges:this.$t.__("The following changes were made that could affect your site rankings:",this.$td),readMore:this.$t.__("Read More",this.$td),viewRevisions:this.$t.__("View Revisions",this.$td)}}},watch:{items(t){this.item={},t.length===1&&(this.item=t[0])}},props:{date:{type:String,default:""},timelineMarkers:{type:Object,default:()=>{}}},methods:{back(t){this.item=this.items.find(e=>e.type===t)||{}},maybeDeleteSeoRevision(t){this.modalOpenDeleteRevisionWarning=!0,this.itemToBeDeleted=t}},computed:{types(){let t=[{name:"wpRevision",title:this.$t.sprintf(this.$t.__("%1$s Revisions",this.$td),"WordPress"),icon:C(W)},{name:"aioseoRevision",title:this.$t.sprintf(this.$t.__("%1$s Revisions",this.$td),"AIOSEO"),icon:C(U)},{name:"googleUpdate",title:this.$t.sprintf(this.$t.__("%1$s Updates",this.$td),"Google"),icon:C(z)}];return t=t.map(e=>({...e,count:this.items.filter(i=>i.type===e.name).length})),t=t.filter(e=>0<e.count),t},type(){return this.types.find(t=>t.name===this.item.type)||{}},title(){return this.date?T(new Date(this.date+" 00:00:00"),this.rootStore.aioseo.data.dateFormat):""},items(){return this.timelineMarkers[this.date]||[]},showTypeSelector(){return 1<this.items.length&&Object.keys(this.item).length===0},showBackButton(){return 1<this.items.length}},mounted(){this.items.length===1&&(this.item=this.items[0])},updated(){this.$emit("update",{item:this.item,modal:this.modalOpen})}},Ve={class:"aioseo-graph-timeline-markers"},Be={class:"aioseo-graph-timeline-markers-title"},Oe={key:0,class:"aioseo-graph-timeline-markers-types"},Le=["onClick"],Ue={class:"aioseo-graph-timeline-markers-types__item-icon"},ze=["alt","src"],We={class:"aioseo-graph-timeline-markers-types__item-title"},Fe={class:"aioseo-graph-timeline-markers-types__item-arrow"},Ye={key:1,class:"aioseo-graph-timeline-markers-item"},He={class:"aioseo-graph-timeline-markers-types__item"},je={class:"aioseo-graph-timeline-markers-types__item-icon"},Ge=["alt","src"],Ke={class:"aioseo-graph-timeline-markers-types__item-title"},qe={key:0},Xe={class:"aioseo-graph-timeline-markers-item__title"},Ze={class:"aioseo-graph-timeline-markers-item__content"},Qe={class:"aioseo-graph-timeline-markers-item__footer"},Je={key:1},et={class:"aioseo-graph-timeline-markers-item__title"},tt={class:"aioseo-graph-timeline-markers-item__content"},st={class:"aioseo-graph-timeline-markers-item__footer"},it={class:"aioseo-graph-timeline-markers-modal__body"},ot={key:0,class:"aioseo-graph-timeline-markers__revisions aioseo-graph-timeline-markers__revisions--wordpress"},rt={class:"aioseo-revision__title"},nt=["innerHTML"],at={key:1,class:"aioseo-graph-timeline-markers__revisions aioseo-graph-timeline-markers__revisions--aioseo"},lt={class:"aioseo-seo-revisions-list"};function dt(t,e,i,l,s,o){const a=_("svg-caret"),m=_("base-button"),y=_("seo-revision-list-item"),b=_("core-modal-portal"),p=_("seo-revisions-delete-warning");return n(),c("div",Ve,[r("div",Be,d(o.title),1),o.showTypeSelector?(n(),c("div",Oe,[(n(!0),c(M,null,E(o.types,(u,w)=>(n(),c("div",{key:w,onClick:()=>o.back(u.name),class:"aioseo-graph-timeline-markers-types__item aioseo-graph-timeline-markers-types__item--clickable"},[r("div",Ue,[r("img",{alt:u.name,src:u.icon},null,8,ze)]),r("div",We,d(u.title)+" ("+d(u.count)+")",1),r("div",Fe,[v(a)])],8,Le))),128))])):h("",!0),o.showTypeSelector?h("",!0):(n(),c("div",Ye,[r("div",He,[r("div",je,[r("img",{alt:o.type.name,src:o.type.icon},null,8,Ge)]),r("div",Ke,d(o.type.title),1)]),s.item.type==="aioseoRevision"||s.item.type==="wpRevision"?(n(),c("div",qe,[r("div",Xe,d(s.strings.theFollowingChanges),1),r("div",Ze,d(s.item.fields.join(", ")),1),r("div",Qe,[o.showBackButton?(n(),f(m,{key:0,type:"gray",onClick:e[0]||(e[0]=()=>o.back()),size:"small"},{default:g(()=>[v(a)]),_:1})):h("",!0),s.item.type==="aioseoRevision"?(n(),f(m,{key:1,type:"blue",size:"small",onClick:e[1]||(e[1]=()=>s.modalOpen=!0)},{default:g(()=>[S(d(s.strings.viewRevisions),1)]),_:1})):h("",!0),s.item.type==="wpRevision"?(n(),f(m,{key:2,href:s.item.link,type:"blue",tag:"a",target:"_blank",size:"small"},{default:g(()=>[S(d(s.strings.viewRevisions),1)]),_:1},8,["href"])):h("",!0)])])):h("",!0),s.item.type==="googleUpdate"?(n(),c("div",Je,[r("div",et,d(s.item.title),1),r("div",tt,d(s.item.description),1),r("div",st,[o.showBackButton?(n(),f(m,{key:0,type:"gray",onClick:e[2]||(e[2]=()=>o.back()),size:"small"},{default:g(()=>[v(a)]),_:1})):h("",!0),s.item.link?(n(),f(m,{key:1,type:"blue",tag:"a",href:s.item.link,target:"_blank",size:"small"},{default:g(()=>[S(d(s.strings.readMore),1)]),_:1},8,["href"])):h("",!0),r("div",{class:D(["aioseo-graph-timeline-markers-item__footer-status",`aioseo-graph-timeline-markers-item__footer-status--${s.item.status}`])},d(s.item.status),3)])])):h("",!0)])),s.modalOpen?(n(),f(b,{key:2,classes:["aioseo-graph-timeline-markers-modal"],onClose:e[3]||(e[3]=()=>this.modalOpen=!1)},{headerTitle:g(()=>[S(d(o.type.title),1)]),body:g(()=>[r("div",it,[s.item.type==="wpRevision"?(n(),c("div",ot,[(n(!0),c(M,null,E(s.item.diff,(u,w)=>(n(),c("div",{key:w,class:"aioseo-graph-timeline-markers__revisions-item"},[r("div",rt,d(u.name),1),r("div",{class:"aioseo-revision__content",innerHTML:u.diff},null,8,nt)]))),128))])):h("",!0),s.item.type==="aioseoRevision"?(n(),c("div",at,[r("div",lt,[(n(!0),c(M,null,E(s.item.revisions,(u,w)=>(n(),f(y,{key:"seo-revision-list-item-"+w,class:"aioseo-graph-timeline-markers__revisions-item",revision:u,compareTo:s.item.compareTo,isCurrentVersion:u.id===s.item.compareTo.id,context:"metabox",onMaybeDeleteSeoRevision:o.maybeDeleteSeoRevision},null,8,["revision","compareTo","isCurrentVersion","onMaybeDeleteSeoRevision"]))),128))])])):h("",!0)])]),_:1})):h("",!0),s.itemToBeDeleted?(n(),f(p,{key:3,modalOpenDeleteRevisionWarning:s.modalOpenDeleteRevisionWarning,revision:s.itemToBeDeleted},null,8,["modalOpenDeleteRevisionWarning","revision"])):h("",!0)])}const ht=R(Pe,[["render",dt]]);const ct={setup(){return{rootStore:N()}},components:{apexchart:F,CoreLoader:$,CorePopper:G,GraphTimelineMarkers:ht},props:{series:{type:Array,required:!0},chartOverrides:{type:Object,default:()=>({})},height:{type:Number,default(){return 350}},legendStyle:{type:String,default(){return"custom"}},loading:{type:Boolean,default:!1},timelineMarkers:{type:Object,default:()=>({})},multiAxis:Boolean,preset:String,invertYAxis:Boolean},data(){return{isMounted:!1,reversedYAxis:!1,colors:["#005AE0","#00AA63","#F18200","#DF2A4A","#8B5CF6","#D946EF"],presets:{overview:{chart:{type:"area",sparkline:{enabled:!0}},grid:{show:!1,padding:{top:2,right:2,bottom:0,left:2}},xaxis:{show:!1},yaxis:{show:!1,labels:{show:!1,formatter:t=>t?x.compactNumber(t):0}}},keywordsDistribution:{chart:{type:"bar",zoom:{enabled:!1},toolbar:{show:!1}},fill:{type:"solid"},stroke:{width:0},xaxis:{type:"category"},yaxis:{forceNiceScale:!1,tickAmount:2,max:100,labels:{formatter:t=>t.toFixed(0)+"%"}},tooltip:{}}},timelineMarkersDate:null}},methods:{handleTimelineMarkersTooltip(t){var e,i;(e=t.referenceElm)==null||e.classList.remove("active-point"),t.showPopper&&((i=t.referenceElm)==null||i.classList.add("active-point"))},handleTimelineMarkersTooltipUpdate(t){const e=this.$refs.timelineMarkersPopper;e.updatePopper(),t.modal?e.doClose():e.doShow(),this.handleTimelineMarkersTooltip(e)},showTimelineMarkersTooltip(t){var i;const e=this.$refs.timelineMarkersPopper;(i=e.referenceElm)==null||i.classList.remove("active-point"),t==null||t.classList.add("active-point"),e.destroyPopper(),e.doDestroy(),e.referenceElm=t,e.createPopper(),e.doShow()}},computed:{getSeries(){const t=this.series;if(!this.invertYAxis||!t.length)return t;const e=t[0].data.map(a=>a.y),i=[];let s=e.map((a,m)=>({value:a,index:m})).sort((a,m)=>a.value-m.value);const o=a=>(i[a[0].index]=a[a.length-1].value,i[a[a.length-1].index]=a[0].value,a=a.slice(1,a.length-1),a);for(;s.length;)s=o(s);return t[0].data.forEach((a,m)=>{a.label=a.y,a.y=i[m]}),t},chartDefaults(){const t=this.series;return{colors:this.colors,chart:{type:"area",zoom:{enabled:!1},toolbar:{show:!1},animations:{enabled:!0,easing:"easeout",speed:600,animateGradually:{enabled:!0,delay:50}},parentHeightOffset:0},fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.4,opacityTo:.9,stops:[0,100]}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},title:{show:!1},grid:{show:!0,strokeDashArray:0,borderColor:"#D0D1D7",yaxis:{lines:{show:!0}},xaxis:{lines:{show:!1}},padding:{top:20,right:20,bottom:20,left:20}},xaxis:{type:"datetime",labels:{show:!0,minHeight:35,trim:!1,rotateAlways:!1,offsetY:6,datetimeFormatter:{year:"yyyy",month:"MMM 'yy",day:"d MMM",hour:""}},tooltip:{enabled:!1,x:{formatter:(e,i)=>{var s,o;const l=new Date(`${(o=(s=t[i.seriesIndex])==null?void 0:s.data[i.dataPointIndex])==null?void 0:o.x} 00:00:00`);return T(l,this.rootStore.aioseo.data.dateFormat)}}},axisBorder:{show:!0,color:"#D0D1D7",height:1,width:"100%",offsetX:0,offsetY:0},axisTicks:{show:!0,borderType:"solid",color:"#E8E8EB",height:12,offsetX:0,offsetY:0}},yaxis:[{labels:{show:!0,formatter:(e,i,l)=>{var o;if(!this.invertYAxis||!(l!=null&&l.config))return e?x.compactNumber(e):0;const s=[...(o=l==null?void 0:l.globals)==null?void 0:o.yAxisScale[0].result].reverse();return s[i]&&(e=s[i]),e?x.compactNumber(e):0}}}],tooltip:{enabled:!0,x:{formatter:(e,i)=>{var s,o;const l=new Date(`${(o=(s=t[i.seriesIndex])==null?void 0:s.data[i.dataPointIndex])==null?void 0:o.x} 00:00:00`);return T(l,this.rootStore.aioseo.data.dateFormat)}},y:{formatter:(e,i)=>{var l,s,o;return this.invertYAxis&&((l=t[i.seriesIndex])!=null&&l.data[i.dataPointIndex].label)?(s=t[i.seriesIndex])==null?void 0:s.data[i.dataPointIndex].label:x.compactNumber((o=t[i.seriesIndex])==null?void 0:o.data[i.dataPointIndex].y)}}},legend:{show:!0,showForSingleSeries:!1,showForNullSeries:!0,showForZeroSeries:!0,position:"bottom",horizontalAlign:"center",floating:!1,fontSize:"14px",fontWeight:400,formatter:(e,i)=>{var o,a,m,y;const l=((a=(o=t[i.seriesIndex])==null?void 0:o.legend)==null?void 0:a.name)||e;if(this.legendStyle==="simple")return[l];let s=((y=(m=t[i.seriesIndex])==null?void 0:m.legend)==null?void 0:y.total)||"";return isNaN(s)||(s=x.compactNumber(s)),[`<strong>${s}</strong>`,l]},inverseOrder:!1,width:void 0,height:void 0,tooltipHoverFormatter:void 0,customLegendItems:[],offsetX:0,offsetY:0,markers:{width:16,height:16,strokeWidth:0,strokeColor:"#fff",fillColors:void 0,radius:16,customHTML:()=>this.legendStyle==="simple"?"":'<span class="marker-checkbox"><svg viewBox="0 0 14 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.8542 1.37147C11.44 0.785682 12.3897 0.785682 12.9755 1.37147C13.5613 1.95726 13.5613 2.907 12.9755 3.49279L6.04448 10.4238C5.74864 10.7196 5.35996 10.8661 4.97222 10.8631C4.58548 10.8653 4.19805 10.7189 3.90298 10.4238L1.0243 7.5451C0.438514 6.95931 0.438514 6.00956 1.0243 5.42378C1.61009 4.83799 2.55983 4.83799 3.14562 5.42378L4.97374 7.2519L10.8542 1.37147Z" fill="currentColor" /></svg></span>',onClick:void 0,offsetX:0,offsetY:0},itemMargin:{horizontal:0,vertical:0},onItemClick:{toggleDataSeries:!0},onItemHover:{highlightDataSeries:!0}},annotations:{points:this.annotationsPoints}}},multiAxisDefaults(){const t=this.series,e={yaxis:[]};return t.forEach((i,l)=>{e.yaxis.push({title:{text:i.name.replace("Search ","")},seriesName:i.name,opposite:l===1,labels:{show:!0,formatter:s=>s?x.compactNumber(s):0}})}),e},annotationsPoints(){const t=[];return this.timelineMarkers&&Object.keys(this.timelineMarkers).forEach(e=>{const i={x:new Date(e).getTime(),y:0,yAxisIndex:0,seriesIndex:0,mouseEnter:(s,o)=>{let a=o.target;o.relatedTarget.tagName.toLowerCase()==="circle"&&(a=o.relatedTarget),this.timelineMarkersDate=e,this.showTimelineMarkersTooltip(a)},label:{text:this.timelineMarkers[e].length,borderWidth:0,offsetY:23,style:{background:"transparent",color:"#141B38",fontSize:"12px",fontWeight:700}},marker:{size:12,strokeWidth:1,strokeColor:"#D0D1D7"},image:{width:17,height:17}},l=this.timelineMarkers[e].map(s=>s.type);if(l.length===1)switch(i.label={},l[0]){case"aioseoRevision":i.image.path=C(U);break;case"googleUpdate":i.image.path=C(z);break;case"wpRevision":i.image.path=C(W);break}t.push(i)}),t},chartPreset(){return this.preset&&this.presets[this.preset]?this.presets[this.preset]:{}},chartOptions(){let t={...this.chartDefaults,...this.chartPreset,...this.chartOverrides};return this.multiAxis&&(t={...t,...this.multiAxisDefaults}),t},chartClasses(){const t=this.series.length;let e=4;return 4<t&&(e=3),[this.loading?"blurred":"",this.preset?this.preset:"",`legend-${this.legendStyle}`,`legend-columns-${e}`].filter(i=>i).map(i=>"aioseo-graph-"+i)}},mounted(){this.isMounted=!0},beforeUnmount(){this.isMounted=!1}},mt={key:0,class:"aioseo-graph"},ut={class:"popper"};function _t(t,e,i,l,s,o){const a=_("apexchart"),m=_("core-loader"),y=_("graph-timeline-markers"),b=_("core-popper");return s.isMounted?(n(),c("div",mt,[v(a,{width:"100%",height:i.height,ref:"apexchart",options:o.chartOptions,series:o.getSeries,class:D(o.chartClasses)},null,8,["height","options","series","class"]),i.loading?(n(),f(m,{key:0,dark:""})):h("",!0),v(b,{ref:"timelineMarkersPopper",options:{placement:"top"},onShow:o.handleTimelineMarkersTooltip,onHide:o.handleTimelineMarkersTooltip},{default:g(()=>[r("span",ut,[s.timelineMarkersDate?(n(),f(y,{key:0,date:s.timelineMarkersDate,timelineMarkers:i.timelineMarkers,onUpdate:o.handleTimelineMarkersTooltipUpdate},null,8,["date","timelineMarkers","onUpdate"])):h("",!0)])]),_:1},8,["onShow","onHide"])])):h("",!0)}const pt=R(ct,[["render",_t]]);const vt={setup(){return{rootStore:N(),searchStatisticsStore:I()}},components:{CoreLoader:$,CoreTooltip:K,Graph:pt,Statistic:Y,SvgCircleQuestionMark:ee},mixins:[H],data(){return{statisticsStrings:[{name:"impressions",label:this.$t.__("Search Impressions",this.$td),tooltip:this.$t.__("This graph shows the <strong>total number of times your website appeared in the search results</strong> within the selected timeframe.",this.$td)},{name:"clicks",label:this.$t.__("Total Clicks",this.$td),tooltip:this.$t.__("This graph shows the <strong>total number of clicks that your website received from the search results</strong> within the selected timeframe.",this.$td)},{name:"ctr",label:this.$t.__("Avg. CTR",this.$td),tooltip:this.$t.__("This graph shows the <strong>average click-through rate of your content in the search results</strong> within the selected timeframe.",this.$td)},{name:"position",label:this.$t.__("Avg. Position",this.$td),tooltip:this.$t.__("This graph shows the <strong>average position of your content in the search results</strong> within the selected timeframe.",this.$td)},{name:"keywords",label:this.$t.__("Total Keywords",this.$td),tooltip:this.$t.__("This graph shows the <strong>total number of keywords that your website ranks for in search results</strong> within the selected timeframe.",this.$td)}]}},props:{statistics:{type:Array,default(){return[]}},statisticsData:{type:Object,default(){return null}},view:{type:String,default:"grid"},showGraph:{type:Boolean,default:!0}},computed:{seoStatistics(){const t=[];return this.statistics.forEach(e=>{const i=this.statisticsStrings.find(l=>l.name===e);i&&t.push({...i,data:this.getData(e)})}),t},style(){const t=[];switch(this.view){case"side-by-side":t.push({"grid-template-columns":`repeat(${this.statistics.length}, 1fr)`});break;case"grid":t.push({"grid-template-columns":`repeat(${Math.ceil(this.statistics.length/2)}, 1fr)`,"grid-template-rows":`repeat(${Math.ceil(this.statistics.length/2)}, 1fr)`});break}return t}},methods:{getData(t){var i,l,s,o,a;const e=this.statisticsData?this.statisticsData:(l=(i=this.searchStatisticsStore.data)==null?void 0:i.seoStatistics)==null?void 0:l.statistics;return e?{total:e[t]||0,difference:e.difference&&Math.abs(e.difference[t])||0,direction:e.difference&&0>e.difference[t]?"down":"up",chart:(a=(o=(s=this.searchStatisticsStore.data)==null?void 0:s.seoStatistics)==null?void 0:o.intervals)==null?void 0:a.map(m=>({x:T(new Date(m.date+" 00:00:00"),this.rootStore.aioseo.data.dateFormat),y:m[t]?m[t]:0}))}:{total:0,difference:0,direction:"up",chart:[]}}}},gt={class:"statistics-title"},ft=["innerHTML"],yt={class:"statistics-current"},bt={class:"statistics-current-total"},kt={key:0,class:"statistics-chart"};function wt(t,e,i,l,s,o){const a=_("svg-circle-question-mark"),m=_("core-tooltip"),y=_("statistic"),b=_("graph"),p=_("core-loader");return n(),c("div",{class:D(["aioseo-seo-statistics-overview",{[i.view]:!0,"hide-graph":!i.showGraph}]),style:Z(o.style)},[(n(!0),c(M,null,E(o.seoStatistics,(u,w)=>(n(),c("div",{key:w,class:"statistics"},[r("div",{class:D([{blurred:l.searchStatisticsStore.loading.seoStatistics}])},[r("div",gt,[S(d(u.label)+" ",1),u.tooltip?(n(),f(m,{key:0},{tooltip:g(()=>[r("span",{innerHTML:u.tooltip},null,8,ft)]),default:g(()=>[v(a)]),_:2},1024)):h("",!0)]),r("div",yt,[r("div",bt,d(t.formatStatistic(u.name,u.data.total)),1),v(y,{class:D(["statistics-current-difference","statistics-current-difference--"+u.data.direction]),difference:u.data.difference,type:u.name,showCurrent:!1,"tooltip-offset":"-90px,0"},null,8,["class","difference","type"])]),i.showGraph?(n(),c("div",kt,[v(b,{series:[{name:u.label,data:u.data.chart}],height:60,preset:"overview","invert-y-axis":u.name==="position"},null,8,["series","invert-y-axis"])])):h("",!0)],2),l.searchStatisticsStore.loading.seoStatistics?(n(),f(p,{key:0,dark:""})):h("",!0)]))),128))],6)}const Bt=R(vt,[["render",wt]]);export{pt as G,Bt as S};
